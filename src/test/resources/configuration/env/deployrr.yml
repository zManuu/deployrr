deployrrVersion: 1.0.0-ALPHA
ssh:
  host: ${SRV_HOST}
  user: ${SRV_USER}
  privateKey: /home/manuel/.ssh/id_rsa
tasks:
  - task: cp
    name: Copy Docker Compose
    opt:
      source: /home/manuel/Desktop/deployrr-docker-compose.yml
      target: /deployment/
  - task: cp
    name: Copy TEST Script
    opt:
      source: /home/manuel/Desktop/deployrr-test.sh
      target: /deployment/
      chmod: +x
  - task: cmd
    name: Execute TEST Script
    opt:
      cmd: ./deployrr-test.sh
      cwd: /deployment/
  - task: docker-compose-up
    name: Start Docker Compose
    opt:
      location: /deployment/deployrr-docker-compose.yml
  - task: healthcheck
    name: Check health
    opt:
      port: 1887
      path: /api/users
      expected: 405
